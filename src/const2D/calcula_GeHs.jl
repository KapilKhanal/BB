function calcula_GeHs(X1,Y1,X2,Y2,CW,FR)
  # integração singular
  #  THIS SUBROUTINE COMPUTES THE VALUES OF THE DIAGONAL
  #  COEFFICIENTS OF THE G MATRIX

  AX=(X2-X1)/2.;
  AY=(Y2-Y1)/2.;
  SR=sqrt(AX^2+AY^2);
  ZR=real(FR*SR/CW);
  Z=complex(0.,ZR);
  S0C=INBESS(Z);
  G=(SR/Z)*S0C/(pi);
  H=0.5;
  return G, H
end

function INBESS(Z)
  #
  #  THIS SUBROUTINE COMPUTES THE INTEGRAL OF THE MODIFIED BESSEL FUNCTION
  #  OF ZERO ORDER BETWEEN 0 AND Z USING A POLINOMIUM.
  #
  #  THE COEFFICIENTS OF THE POLINOMIUM HAVE BEEN OBTAINED FROM THE
  #  TERMS OF THE SERIES EXPANSION

  S0=0.42278434;
  S1=[0.90734120e+01, 0.72756425E+02, 0.25901019E+03,  0.52398212e+03, 0.68598066e+03, 0.62976149e+03,  0.42826262E+03, 0.22451590E+03, 0.93540077E+02,  0.31723213E+02, 0.89292258E+01, 0.21196877E+01,  0.43013488E+00, 0.75474799E-01, 0.11565621E-01,  0.15612002E-02, 0.18705605E-03, 0.20027866E-04,  0.19277885E-05, 0.16772276E-06];

  S2=[0.12000000E+02, 0.64800000E+02, 0.18514286E+03,  0.32400000E+03, 0.38173091E+03, 0.32300308E+03, 0.20566727E+03, 0.10207750E+03, 0.40592223E+02,  0.13221467E+02, 0.35916023E+01, 0.82606852E+00,   0.16293265E+00, 0.27862515E-01, 0.41703893E-02,  0.55091790E-03, 0.64704940E-04, 0.68008195E-05, 0.64341868E-06, 0.55082916E-07];

  R=abs(Z);
  RR=12.0;
  if(R-RR)<0
    N=max(1,min(20.,19.572/log(RR/R)));
  else
    N=20;
    println(" INBESS: RESULTS MAY BE INACCURATE ")
  end
  ZZ=Z/complex(RR,0.);
  ZZ=ZZ*ZZ;
  FINK0=-log(Z/complex(2.,0.))*(complex(1.,0.)+SER(S2,ZZ,1,N));
  FINK0=Z*(complex(S0,0.)+SER(S1,ZZ,1,N)+FINK0);

  return FINK0
end

function SER(S,ZZ,N1,N2)

  #  THIS FUNCTION COMPUTES THE VALUE OF A SERIES OF N2-N1+1
  #  TERMS CONSISTING OF INCREASING POWERS OF ZZ TIMES THE
  #  COEFFICIENTS IN ARRAY S

  y=complex(0.,0.);
  ZZZ=complex(1.,0.);
  i::Int64 = 1;
  for i=N1:N2
    ZZZ=ZZZ*ZZ;
    y=y+complex(S[i],0.)*ZZZ;
  end

  return y
end
